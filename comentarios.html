<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Comentarios en tiempo real</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #2b2b2b; /* Fondo gris oscuro */
    margin: 0;
    padding: 10px;
  }
  #comentarios-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-width: 600px;
    margin: auto;
  }
  .comentario {
    background-color: #3c3c3c; /* Burbujas un poco más claras */
    color: #ffffff; /* Texto blanco */
    padding: 10px;
    border-radius: 8px;
    box-shadow: 0 0 5px rgba(0,0,0,0.5);
  }
  .nombre {
    font-weight: bold;
  }
  .nombre.tuyo {
    color: #00ff00; /* Tu nombre en verde */
  }
  .fecha {
    font-size: 0.8em;
    color: #bbbbbb; /* Fecha en gris claro */
  }
  #form-comentario {
    display:flex;
    flex-direction: column;
    gap:5px;
    max-width:600px;
    margin:20px auto;
  }
  #nombre, #mensaje {
    padding:8px;
    border-radius:5px;
    border:1px solid #555555;
    background-color:#3c3c3c;
    color:#ffffff;
    width:100%;
    box-sizing:border-box;
  }
  #btn-comentar {
    padding:10px;
    background-color:#00ff00;
    color:black;
    border:none;
    border-radius:5px;
    cursor:pointer;
    font-weight:bold;
    text-shadow:0 0 2px black;
  }
</style>
</head>
<body>

<div id="comentarios-container"></div>

<div id="form-comentario">
  <input type="text" id="nombre" placeholder="Tu nombre">
  <textarea id="mensaje" placeholder="Escribe tu comentario"></textarea>
  <button id="btn-comentar">COMENTAR</button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDgnZ4h-4xTpDcHqCxmgzNhmKze4HWM-yM",
    authDomain: "mcbe-zringpvp.firebaseapp.com",
    databaseURL: "https://mcbe-zringpvp-default-rtdb.firebaseio.com",
    projectId: "mcbe-zringpvp",
    storageBucket: "mcbe-zringpvp.firebasestorage.app",
    messagingSenderId: "14416072803",
    appId: "1:14416072803:web:d1e786dda7292af64ee856",
    measurementId: "G-97CLB6FPS1"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database().ref('comentarios');

  const tuNombre = "zRingPvP";

  // Mostrar comentarios en tiempo real
  db.on('value', snapshot => {
    const container = document.getElementById('comentarios-container');
    container.innerHTML = '';
    snapshot.forEach(child => {
      const data = child.val();
      const div = document.createElement('div');
      div.className = 'comentario';
      const nombreSpan = document.createElement('span');
      nombreSpan.className = 'nombre' + (data.nombre === tuNombre ? 'tuyo' : '');
      nombreSpan.textContent = data.nombre;
      const fechaSpan = document.createElement('span');
      fechaSpan.className = 'fecha';
      fechaSpan.textContent = ' (' + data.fecha + ')';
      const mensajeDiv = document.createElement('div');
      mensajeDiv.textContent = data.mensaje;
      div.appendChild(nombreSpan);
      div.appendChild(fechaSpan);
      div.appendChild(document.createElement('br'));
      div.appendChild(mensajeDiv);
      container.appendChild(div);
    });

    // Ajuste de altura del iframe
    if(window.parent){
      window.parent.postMessage({ type:'resize-iframe', height: document.body.scrollHeight }, '*');
    }
  });

  // Agregar comentario
  document.getElementById('btn-comentar').onclick = () => {
    const nombre = document.getElementById('nombre').value.trim();
    const mensaje = document.getElementById('mensaje').value.trim();
    if(!nombre || !mensaje) { alert('Completa ambos campos'); return; }

    // Bloqueo de tu nombre
    if(nombre === tuNombre && !confirm('Solo tú puedes usar este nombre. ¿Estás seguro?')) return;

    const fecha = new Date().toLocaleString();
    db.push({ nombre, mensaje, fecha });
    document.getElementById('mensaje').value = '';
  };
</script>

</body>
</html>
